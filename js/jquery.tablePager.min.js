/*
* TablePager 1.02, jQuery plugin
*
* Copyright(c) 2012, Adam Radabaugh
*
* Simple AJAX table pagination
* Licensed under the MIT License
*/
(function(a){var b=function b(){function b(a){return a.data("jqv-table-pager")}function c(a,b){a.data("jqv-table-pager",b)}function d(a){a.removeData("jqv-table-pager")}function e(a){var c=b(a),d="1/1",e=0,f=1,g=0,h=c.offset,i=c.pageSize;for(f=Math.ceil(c.resultCount/i);;)if(g+=i,e+=1,g>h)break;e=e||1,f=f||1,d=e+"/"+f,c.pager.find(".page-display").val(d),c=d=e=f=a=g=h=i=null}function f(d){var f=b(d),g=a.extend({},{offset:f.offset,pageSize:f.pageSize},f.ajaxData),h=!0;"function"==typeof f.beforeRequestCallback&&(h=f.beforeRequestCallback()),h!==!1&&a.get(f.requestURL,g,function(b){if("string"==typeof b&&(b=a.parseJSON(b)),null==b.max||""===b.max)return console.error("No `max` was specified in result for jQuery.tablePager."),void 0;f.resultCount=b.max;var h=f.requestCallback(b,f);"string"==typeof f.target?a(f.target).html(h):"object"==typeof f.target&&"string"==typeof f.target.jquery&&f.target.html(h),c(d,f),e(d),"function"==typeof f.afterRequestCallback&&f.afterRequestCallback(),b=f=d=g=h=null},"JSON")}function g(a){var d=b(a);d.offset>0&&(d.offset=0,c(a,d),f(a)),d=a=null}function h(a){var d=b(a);d.offset>0&&d.offset>=d.pageSize&&(d.offset=d.offset-d.pageSize,c(a,d),f(a)),d=a=null}function i(a){var d=b(a);d.offset<d.resultCount-d.pageSize&&(d.offset=d.offset+d.pageSize,c(a,d),f(a)),d=a=null}function j(a){var d=b(a),e=d.pageSize,g=d.resultCount,h=0;if(d.offset<d.resultCount-d.pageSize){for(;;)if(h+=e,e>g-h){d.offset=h;break}c(a,d),f(a)}d=a=e=g=h=null}function k(b){var d="";return a.each(b.records,function(b,c){d+="<tr>",a.each(c,function(a,b){d=d+"<td>"+b+"</td>"}),d+="</tr>"}),d}function l(a){var c=b(a);a.find(c.firstButton).unbind("click.tablePager").bind("click.tablePager",function(b){b.preventDefault(),g(a)}),a.find(c.prevButton).unbind("click.tablePager").bind("click.tablePager",function(b){b.preventDefault(),h(a)}),a.find(c.nextButton).unbind("click.tablePager").bind("click.tablePager",function(b){b.preventDefault(),i(a)}),a.find(c.lastButton).unbind("click.tablePager").bind("click.tablePager",function(b){b.preventDefault(),j(a)}),c=null,f(a)}function m(b,d){var e=a.extend({target:"",requestURL:"",pageSize:20,ajaxData:{},requestCallback:k,beforeRequestCallback:null,afterRequestCallback:null,firstButton:".first-page",prevButton:".prev-page",nextButton:".next-page",lastButton:".last-page"},d);return e.offset=0,e.resultCount=e.pageSize,e.pager=b,null==e.target||""===e.target?(console.error("No `target` was specified for jQuery.tablePager."),!1):null==e.requestURL||""===e.requestURL?(console.error("No `requestURL` was specified for jQuery.tablePager."),!1):(c(b,e),e=null,!0)}function n(){var a=arguments[0],c=b(a);return a.find(c.firstButton).unbind("click.tablePager"),a.find(c.prevButton).unbind("click.tablePager"),a.find(c.nextButton).unbind("click.tablePager"),a.find(c.lastButton).unbind("click.tablePager"),d(a),a}function o(){var a=arguments[0],d=b(a);return d.offset=0,c(a,d),f(a),d=null,a}function p(){var a=arguments[0],d=arguments[2],e=arguments[3],g=b(a),h=!1;return null==e?g.hasOwnProperty(d)?g[d]:void 0:"offset"!==d&&"resultCount"!==d&&"pager"!==d&&g[d]?(g[d]=e,("pageSize"===d||"requestURL"===d||"target"===d)&&(g.offset=0,h=!0),c(a,g),h&&f(a),g=h=null,a):a}function q(a,b){if(b=b||{},null==a.data("jqv-table-pager")){if(!m(a,b))return!1;l(a)}a=null}return{init:q,option:p,refresh:o,destroy:n}}();a.fn.tablePager=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d[0],f=[];return c[0]?"string"==typeof e&&"init"!==e&&b[e]?(f.push(c),a.each(d,function(a,b){f.push(b)}),b.init(c,e),b[e].apply(null,f)):("object"!=typeof e&&e?console.error("Method "+e+" does not exist in jQuery.tablePager"):b.init(c,e),d=e=f=null,c):!1}})(jQuery);