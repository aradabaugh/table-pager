/*
* TablePager 1.01, jQuery plugin
*
* Copyright(c) 2012, Adam Radabaugh
*
* Simple AJAX table pagination
* Licensed under the MIT License
*/
(function(a){var b=function(){function c(a){return a.data("jqv-table-pager")}function d(a,b){a.data("jqv-table-pager",b)}function e(a){a.removeData("jqv-table-pager")}function f(a){var b=c(a),d="1/1",e=0,f=1,g=0,h=b.offset,i=b.pageSize;f=Math.ceil(b.resultCount/i);for(;;){g+=i,e+=1;if(h<g)break}e=e||1,f=f||1,d=e+"/"+f,b.pager.find(".page-display").val(d),b=d=e=f=a=g=h=i=null}function g(b){var e=c(b),g=a.extend({},{offset:e.offset,pageSize:e.pageSize},e.ajaxData);a.get(e.requestURL,g,function(c){typeof c=="string"&&(c=a.parseJSON(c));if(c.max==null||c.max===""){console.error("No `max` was specified in result for jQuery.tablePager.");return}e.resultCount=c.max;var h=e.requestCallback(c,e);typeof e.target=="string"?a(e.target).html(h):typeof e.target=="object"&&typeof e.target.jquery=="string"&&e.target.html(h),d(b,e),f(b),c=e=b=g=h=null},"JSON")}function h(a){var b=c(a);b.offset>0&&(b.offset=0,d(a,b),g(a)),b=a=null}function i(a){var b=c(a);b.offset>0&&b.offset>=b.pageSize&&(b.offset=b.offset-b.pageSize,d(a,b),g(a)),b=a=null}function j(a){var b=c(a);b.offset<b.resultCount-b.pageSize&&(b.offset=b.offset+b.pageSize,d(a,b),g(a)),b=a=null}function k(a){var b=c(a),e=b.pageSize,f=b.resultCount,h=0;if(b.offset<b.resultCount-b.pageSize){for(;;){h+=e;if(f-h<e){b.offset=h;break}}d(a,b),g(a)}b=a=e=f=h=null}function l(b,c){var d="";return a.each(b.records,function(b,c){d+="<tr>",a.each(c,function(a,b){d=d+"<td>"+b+"</td>"}),d+="</tr>"}),d}function m(a){var b=c(a);a.find(b.firstButton).bind("click.tablePager",function(b){b.preventDefault(),h(a)}),a.find(b.prevButton).bind("click.tablePager",function(b){b.preventDefault(),i(a)}),a.find(b.nextButton).bind("click.tablePager",function(b){b.preventDefault(),j(a)}),a.find(b.lastButton).bind("click.tablePager",function(b){b.preventDefault(),k(a)}),b=null,g(a)}function n(b,c){var e=a.extend({target:"",requestURL:"",pageSize:20,ajaxData:{},requestCallback:l,firstButton:".first-page",prevButton:".prev-page",nextButton:".next-page",lastButton:".last-page"},c);return e.offset=0,e.resultCount=e.pageSize,e.pager=b,e.target==null||e.target===""?(console.error("No `target` was specified for jQuery.tablePager."),!1):e.requestURL==null||e.requestURL===""?(console.error("No `requestURL` was specified for jQuery.tablePager."),!1):(d(b,e),e=null,!0)}function o(){var a=arguments[0],b=c(a);return a.find(b.firstButton).unbind("click.tablePager"),a.find(b.prevButton).unbind("click.tablePager"),a.find(b.nextButton).unbind("click.tablePager"),a.find(b.lastButton).unbind("click.tablePager"),e(a),a}function p(){var a=arguments[0],b=c(a);return b.offset=0,d(a,b),g(a),b=null,a}function q(){var a=arguments[0],b=arguments[2],e=arguments[3],f=c(a),h=!1;if(e==null)return f.hasOwnProperty(b)?f[b]:undefined;if(b==="offset"||b==="resultCount"||b==="pager"||!f[b])return a;f[b]=e;if(b==="pageSize"||b==="requestURL"||b==="target")f.offset=0,h=!0;return d(a,f),h&&g(a),f=h=null,a}function r(a,b){b=b||{};if(a.data("jqv-table-pager")==null){if(!n(a,b))return!1;m(a)}a=null}return{init:r,option:q,refresh:p,destroy:o}}();a.fn.tablePager=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d[0],f=[];return c[0]?typeof e=="string"&&e!=="init"&&b[e]?(f.push(c),a.each(d,function(a,b){f.push(b)}),b.init(c,e),b[e].apply(null,f)):(typeof e=="object"||!e?b.init(c,e):console.error("Method "+e+" does not exist in jQuery.tablePager"),d=e=f=null,c):!1}})(jQuery);