/*
* TablePager 1.02, jQuery plugin
*
* Copyright(c) 2012, Adam Radabaugh
*
* Simple AJAX table pagination
* Licensed under the MIT License
*/
(function(e){var t=function(){function n(e){return e.data("jqv-table-pager")}function r(e,t){e.data("jqv-table-pager",t)}function i(e){e.removeData("jqv-table-pager")}function s(e){var t=n(e),r="1/1",i=0,s=1,o=0,u=t.offset,a=t.pageSize;s=Math.ceil(t.resultCount/a);for(;;){o+=a,i+=1;if(u<o)break}i=i||1,s=s||1,r=i+"/"+s,t.pager.find(".page-display").val(r),t=r=i=s=e=o=u=a=null}function o(t){var i=n(t),o=e.extend({},{offset:i.offset,pageSize:i.pageSize},i.ajaxData),u=!0;typeof i.beforeRequestCallback=="function"&&(u=i.beforeRequestCallback()),u!==!1&&e.get(i.requestURL,o,function(n){typeof n=="string"&&(n=e.parseJSON(n));if(n.max==null||n.max===""){console.error("No `max` was specified in result for jQuery.tablePager.");return}i.resultCount=n.max;var u=i.requestCallback(n,i);typeof i.target=="string"?e(i.target).html(u):typeof i.target=="object"&&typeof i.target.jquery=="string"&&i.target.html(u),r(t,i),s(t),typeof i.afterRequestCallback=="function"&&i.afterRequestCallback(),n=i=t=o=u=null},"JSON")}function u(e){var t=n(e);t.offset>0&&(t.offset=0,r(e,t),o(e)),t=e=null}function a(e){var t=n(e);t.offset>0&&t.offset>=t.pageSize&&(t.offset=t.offset-t.pageSize,r(e,t),o(e)),t=e=null}function f(e){var t=n(e);t.offset<t.resultCount-t.pageSize&&(t.offset=t.offset+t.pageSize,r(e,t),o(e)),t=e=null}function l(e){var t=n(e),i=t.pageSize,s=t.resultCount,u=0;if(t.offset<t.resultCount-t.pageSize){for(;;){u+=i;if(s-u<i){t.offset=u;break}}r(e,t),o(e)}t=e=i=s=u=null}function c(t,n){var r="";return e.each(t.records,function(t,n){r+="<tr>",e.each(n,function(e,t){r=r+"<td>"+t+"</td>"}),r+="</tr>"}),r}function h(e){var t=n(e);e.find(t.firstButton).unbind("click.tablePager").bind("click.tablePager",function(t){t.preventDefault(),u(e)}),e.find(t.prevButton).unbind("click.tablePager").bind("click.tablePager",function(t){t.preventDefault(),a(e)}),e.find(t.nextButton).unbind("click.tablePager").bind("click.tablePager",function(t){t.preventDefault(),f(e)}),e.find(t.lastButton).unbind("click.tablePager").bind("click.tablePager",function(t){t.preventDefault(),l(e)}),t=null,o(e)}function p(t,n){var i=e.extend({target:"",requestURL:"",pageSize:20,ajaxData:{},requestCallback:c,beforeRequestCallback:null,aferRequestCallback:null,firstButton:".first-page",prevButton:".prev-page",nextButton:".next-page",lastButton:".last-page"},n);return i.offset=0,i.resultCount=i.pageSize,i.pager=t,i.target==null||i.target===""?(console.error("No `target` was specified for jQuery.tablePager."),!1):i.requestURL==null||i.requestURL===""?(console.error("No `requestURL` was specified for jQuery.tablePager."),!1):(r(t,i),i=null,!0)}function d(){var e=arguments[0],t=n(e);return e.find(t.firstButton).unbind("click.tablePager"),e.find(t.prevButton).unbind("click.tablePager"),e.find(t.nextButton).unbind("click.tablePager"),e.find(t.lastButton).unbind("click.tablePager"),i(e),e}function v(){var e=arguments[0],t=n(e);return t.offset=0,r(e,t),o(e),t=null,e}function m(){var e=arguments[0],t=arguments[2],i=arguments[3],s=n(e),u=!1;if(i==null)return s.hasOwnProperty(t)?s[t]:undefined;if(t==="offset"||t==="resultCount"||t==="pager"||!s[t])return e;s[t]=i;if(t==="pageSize"||t==="requestURL"||t==="target")s.offset=0,u=!0;return r(e,s),u&&o(e),s=u=null,e}function g(e,t){t=t||{};if(e.data("jqv-table-pager")==null){if(!p(e,t))return!1;h(e)}e=null}return{init:g,option:m,refresh:v,destroy:d}}();e.fn.tablePager=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r[0],s=[];return n[0]?typeof i=="string"&&i!=="init"&&t[i]?(s.push(n),e.each(r,function(e,t){s.push(t)}),t.init(n,i),t[i].apply(null,s)):(typeof i=="object"||!i?t.init(n,i):console.error("Method "+i+" does not exist in jQuery.tablePager"),r=i=s=null,n):!1}})(jQuery);